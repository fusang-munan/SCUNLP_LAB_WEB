{{- define "main" -}}

<div class="universal-wrapper">
  <div class="article-header">
    <h1 class="article-title">{{ .Title }}</h1>
  </div>
</div>

<div class="universal-wrapper">
  <div class="news-timeline">
    {{/* 按 weight 降序排列（weight 大的排在前面） */}}
    {{ range .Pages.ByWeight.Reverse }}
    <div class="news-timeline-item">
      <div class="news-timeline-date">
        <span class="news-date-text">{{ .Date.Format "2006-01-02" }}</span>
        <span class="news-date-arrow">▼</span>
        <span class="news-date-line"></span>
      </div>
      <div class="news-timeline-content">
        {{/* 左侧：封面图 */}}
        {{ $image := .Resources.GetMatch "featured*" }}
        {{ if not $image }}
          {{ $image = (.Resources.ByType "image").GetMatch "{*cover*,*thumbnail*,*banner*}" }}
        {{ end }}
        {{ if not $image }}
          {{/* 从 images 子目录中取第一张图 */}}
          {{ $allImages := .Resources.ByType "image" }}
          {{ if $allImages }}
            {{ $image = index $allImages 0 }}
          {{ end }}
        {{ end }}
        {{ if $image }}
        <div class="news-timeline-image">
          <a href="{{ .RelPermalink }}">
            <img src="{{ $image.RelPermalink }}" alt="{{ .Title }}" loading="lazy">
          </a>
        </div>
        {{ end }}
        {{/* 右侧：标题 + 摘要 + 按钮 */}}
        <div class="news-timeline-info{{ if not $image }} news-timeline-info-full{{ end }}">
          <h2 class="news-timeline-title">
            <a href="{{ .RelPermalink }}">{{ .Title }}</a>
          </h2>
          {{ if .Params.summary }}
          <p class="news-timeline-summary">{{ .Params.summary }}</p>
          {{ else }}
          <p class="news-timeline-summary">{{ .Summary | plainify | truncate 120 }}</p>
          {{ end }}
          <div class="news-timeline-action">
            <a href="{{ .RelPermalink }}" class="news-read-more">
              {{ i18n "news_read_more" | default "了解更多" }}
            </a>
          </div>
        </div>
      </div>
    </div>
    {{ end }}
  </div>
</div>

{{- end -}}